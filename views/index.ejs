<%- include('layouts/header') %>

<!-- ================= MOBILE CATEGORY SLIDER (ONLY MOBILE) ================= -->
<div class="container-fluid bg-white py-2 border-bottom d-lg-none mt-5">
  <div class="d-flex overflow-auto px-2 mobile-category-slider">
    <% if(categories){ categories.forEach(category => { %>
      <a href="/category/<%= category._id %>"
         class="text-center text-decoration-none text-dark me-3 flex-shrink-0">
        <div class="mobile-cat-circle mb-1">
          <% if(category.image && category.image.length > 0){ %>
            <img src="<%= category.image[0].url %>" alt="">
          <% } else { %>
            <img src="/img/no-image-available-icon-vector.jpg" alt="">
          <% } %>
        </div>
        <small class="d-block fw-semibold text-truncate" style="max-width:70px">
          <%= category.category_name %>
        </small>
      </a>
    <% }) } %>
  </div>
</div>
<!-- ================= END MOBILE CATEGORY SLIDER ================= -->

<!-- ================= TOAST ================= -->
<div class="toast-container position-fixed top-0 end-0 p-4">
  <% if (success && success.length > 0) { success.forEach(function(e) { %>
    <div class="toast align-items-center text-bg-success border-0 show">
      <div class="d-flex align-items-center">
        <div class="toast-body"><%= e %></div>
        <button type="button" class="btn-close btn-close-white ms-auto me-2"
                data-bs-dismiss="toast"></button>
      </div>
    </div>
  <% }) } %>
</div>

<!-- ================= CAROUSEL ================= -->
<div class="container-fluid mb-3">
  <div class="row">
    <div class="col-lg-12 p-0">
      <div id="header-carousel"
           class="carousel slide carousel-fade mb-30 mb-lg-0"
           data-ride="carousel">

        <% if(sliders && sliders.length > 0){ %>
        <ol class="carousel-indicators">
          <% sliders.forEach((slider,index)=>{ %>
            <li data-target="#header-carousel"
                data-slide-to="<%= index %>"
                class="<%= index === 0 ? 'active' : '' %>"></li>
          <% }) %>
        </ol>

        <div class="carousel-inner">
          <% sliders.forEach((slider,index)=>{ %>
            <div class="carousel-item position-relative <%= index === 0 ? 'active' : '' %>"
                 style="height: 500px;">
              <img class="position-absolute w-100 h-100"
                   src="<%= slider.image[0].url %>"
                   style="object-fit: cover;">
              <div class="carousel-caption d-flex flex-column align-items-center justify-content-center">
                <div class="p-3" style="max-width: 700px;">
                  <h1 class="display-4 text-white mb-3 animate__animated animate__fadeInDown slider-title">
                    <%= slider.title %>
                  </h1>
                  <p class="text-white mb-3 animate__animated animate__fadeInDown slider-desc">
                    <%= slider.description %>
                  </p>
                  <a class="btn btn-outline-light py-2 px-4 mt-lg-3 animate__animated animate__fadeInUp"
                     href="/category/<%= slider.category_id %>?s=<%= slider.subcategory_id %>">
                    Shop Now
                  </a>
                </div>
              </div>
            </div>
          <% }) } %>
        </div>

      </div>
    </div>
  </div>
</div>
<!-- ================= END CAROUSEL ================= -->


    <!-- Featured Start -->
    <div class="container-fluid pt-lg-5">
    <div class="row px-xl-5 pb-0">
        <div class="col-6 col-md-6 col-lg-3 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 20px;">
                <h1 class="fa fa-check text-primary m-0 mr-3"></h1>
                <h5 class="font-weight-semi-bold m-0">Quality Product</h5>
            </div>
        </div>

        <div class="col-6 col-md-6 col-lg-3 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 20px;">
                <h1 class="fa fa-shipping-fast text-primary m-0 mr-2"></h1>
                <h5 class="font-weight-semi-bold m-0">Free Shipping</h5>
            </div>
        </div>

        <div class="col-6 col-md-6 col-lg-3 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 20px;">
                <h1 class="fas fa-exchange-alt text-primary m-0 mr-3"></h1>
                <h5 class="font-weight-semi-bold m-0">14-Day Return</h5>
            </div>
        </div>

        <div class="col-6 col-md-6 col-lg-3 pb-1">
            <div class="d-flex align-items-center bg-light mb-4" style="padding: 20px;">
                <h1 class="fa fa-phone-volume text-primary m-0 mr-3"></h1>
                <h5 class="font-weight-semi-bold m-0">24/7 Support</h5>
            </div>
        </div>
    </div>
</div>

    <!-- Featured End -->
<!-- Categories Start -->
    <div class="container-fluid pt-3 d-none d-lg-block">
        <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4"><span class="bg-secondary pr-3">Categories</span></h2>
        <div class="row px-xl-5 pb-3">   
        <%  let count = 0
            if(categories) { 
            categories.forEach((category,index)=>{ 
            count++
            if(count < 9){
            %> 
            <div class="col-lg-3 col-md-4 col-sm-6 pb-1">
                <a class="text-decoration-none" href="/category/<%= category._id %>">
                    <div class="cat-item d-flex align-items-center mb-4">
                        <div class="overflow-hidden" style="width: 100px; height: 100px;">
                            
                        <% if(category.image && category.image.length > 0) { %> 
                            <img class="img-fluid" src="<%= category.image[0].url %>"  style="width:100%; height:100%; object-fit: cover;"alt="">
                        <% }else { %>    
                            <img class="img-fluid" src="/img/no-image-available-icon-vector.jpg" alt="">
                        <% } %>    
                        </div>
                        <div class="flex-fill pl-3">
                            <h6><%= category.category_name %></h6>
                            <small class="text-body"><%= productCount[index] %> Products</small>
                        </div>
                    </div>
                  </a>
               </div>
           <%  } }) }%>
        </div>
    </div>
    <!-- Categories End -->


    <!-- Products Start -->
    <div class="container-fluid pt-5 pb-3">
    <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4">
        <span class="bg-secondary pr-3">Featured Products</span>
    </h2>

    <div class="row px-xl-5">
        <% if (products && products.length > 0) {
            function shortTital(title) {
                const Title = title.split(' ')
                return `${Title[0]} ${Title[1] || ''}...`
            }

            products.forEach((product, index) => {
                if (index < 8) {
        %>
        <div class="col-6 col-md-4 col-lg-3 pb-2">
            <a href="product-detail/<%= product.slug %>" class="text-decoration-none">
                <div class="product-item bg-light h-100">

                    <div class="product-img position-relative overflow-hidden">
                        <img class="" src="<%= product.images[0].url[0] ? product.images[0].url[0] :'/img/no-image-available-icon-vector.jpg'%>" width="100%" height="300px!important" style="object-fit: scale-down;" alt="">
                    </div>

                    <div class="text-center py-3 px-2">
                        <h6 class="product-title text-truncate mb-2">
                            <%= shortTital(product.product_name) %>
                        </h6>

                        <div class="d-flex align-items-center justify-content-center flex-wrap">
                            <h6 class="mb-0 text-primary">
                                Rs. <%= product.price - product.discount %>
                            </h6>
                            <small class="text-muted ml-2">
                                <del>Rs. <%= product.price %></del>
                            </small>
                        </div>
                    </div>

                </div>
            </a>
        </div>

        <% } }) } %>
    </div>
</div>

    <!-- Products End -->


    <!-- Offer Start -->
    <div class="container-fluid pt-5 pb-3">
        <div class="row px-xl-5">
            <div class="col-md-6">
                <div class="product-offer mb-30" style="height: 300px;">
                    <img class="img-fluid" src="img/offer-1.jpg" alt="">
                    <div class="offer-text">
                        <h6 class="text-white text-uppercase">Save 20%</h6>
                        <h3 class="text-white mb-3">Special Offer</h3>
                        <a href="" class="btn btn-primary">Shop Now</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="product-offer mb-30" style="height: 300px;">
                    <img class="img-fluid" src="img/offer-2.jpg" alt="">
                    <div class="offer-text">
                        <h6 class="text-white text-uppercase">Save 20%</h6>
                        <h3 class="text-white mb-3">Special Offer</h3>
                        <a href="" class="btn btn-primary">Shop Now</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Offer End -->


    <!-- Products Start -->
    <div class="container-fluid pt-5 pb-3">
    <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4">
        <span class="bg-secondary pr-3">Recent Products</span>
    </h2>

    <div class="row px-xl-5">
        <% if (recentProducts && recentProducts.length > 0) {
            function shortTital(title) {
                const Title = title.split(' ')
                return `${Title[0]} ${Title[1] || ''}...`
            }

            recentProducts.forEach((product, index) => {
                if (index < 8) {
        %>
        <div class="col-6 col-md-4 col-lg-3 pb-3">
            <a href="product-detail/<%= product.slug %>" class="text-decoration-none">
                <div class="product-item bg-light h-100">

                    <div class="product-img position-relative overflow-hidden">
                        <img class="" src="<%= product.images[0].url[0] ? product.images[0].url[0] :'/img/no-image-available-icon-vector.jpg'%>" width="100%" height="300px!important" style="object-fit: scale-down;" alt="">
                    </div>

                    <div class="text-center py-3 px-2">
                        <h6 class="product-title text-truncate mb-2">
                            <%= shortTital(product.product_name) %>
                        </h6>

                        <div class="d-flex align-items-center justify-content-center flex-wrap">
                            <h6 class="mb-0 text-primary">
                                Rs. <%= product.price - product.discount %>
                            </h6>
                            <small class="text-muted ml-2">
                                <del>Rs. <%= product.price %></del>
                            </small>
                        </div>
                    </div>

                </div>
            </a>
        </div>

        <% } }) } %>
    </div>
</div>

    <!-- Products End -->
<%- include('layouts/footer') %>
