<%- include('layouts/header') %>

<style>
.tracking-steps {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap; /* Allow steps to wrap on smaller screens */
    gap: 1rem; /* Space between steps */
    margin-bottom: 2rem;
}
.icon {

}
/* Each step */
.tracking-step {
    flex: 1 1 100px; /* Flexible width, min 100px */
    text-align: center;
    position: relative;
    padding: 0.5rem 0;
}

/* Icons */
.tracking-step .icon {
    font-size: 1.5rem;
    margin-bottom: 0.25rem;
}

/* Completed step */
.tracking-step.completed .icon,
.tracking-step.completed h6 {
   /* color: #28a745;  green for completed */
}

/* Failed step */
.tracking-step.failed .icon,
.tracking-step.failed h6 {
    /*color: #dc3545;  red for failed */
}

/* Step titles */
.tracking-step h6 {
    margin: 0.25rem 0;
    font-size: 0.9rem;
}

/* Step dates */
.tracking-step small {
    display: block;
    font-size: 0.75rem;
    color: #6c757d;
}

/* Small screen adjustments */
@media (max-width: 767px) {
    .tracking-steps {
        flex-direction: column; /* Stack steps vertically on mobile */
        align-items: flex-start;
    }

    .tracking-step {
        flex: 1 1 100%;
        text-align: left;
        display: flex;
        align-items: center;
        width: 100%;
        justify-content: space-between;
    }

    .tracking-step .icon {
        margin-right: 0.75rem;
        font-size: 1.25rem;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 15%;
        margin: 0;
    }

    .tracking-step small {
        font-size: 0.7rem;
    }
    .tracking-step .icon{
        padding: 10px;
    }
    .tracking-steps::before {
        content: '';
        position: absolute;
        top: 22px;
        left: 19px;
        right: 0;
        height: 311px;
        background: #e9ecef;
        z-index: 1;
        width: 5px;
    }
}
</style>


<div class="container py-5">

    <div class="text-center mb-5">
        <h2 class="font-weight-bold">Order Tracking</h2>
        <p class="text-muted">Payment & delivery progress</p>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">

            <!-- Order Summary -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <strong>Order ID</strong>
                    <p class="text-muted mb-0"><%= order.razorpay_order_id %></p>
                </div>
                <div class="col-md-3">
                    <strong>Order Date</strong>
                    <p class="text-muted mb-0"><%= new Date(order.createdAt).toLocaleDateString() %></p>
                </div>
                <div class="col-md-3">
                    <strong>Payment Method</strong>
                    <p class="text-muted mb-0"><%= order.payment_method %></p>
                </div>
                <div class="col-md-3">
                    <strong>Total Amount</strong>
                    <p class="text-success font-weight-bold mb-0">Rs : <%= order.total %></p>
                </div>
            </div>

            <hr>

            <!-- Tracking Progress -->
            <div class="tracking-steps">
                    <!-- Order Placed -->
                    <div class="tracking-step <%= order.steps.includes('confirmed') ? 'completed' : '' %> ">
                        <div class="icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h6>Order Placed</h6>
                        <small class="text-muted"><%= new Date(order.updatedAt).toLocaleDateString() %></small>
                    </div>
                
                <!-- Payment -->
                <div class="tracking-step <%= order.payment_status == 'paid' ? 'completed' : '' %> <%= order.payment_status == 'failed' ? 'failed' : '' %>" >
                    <div class="icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <h6>Payment Paid</h6>
                    <small class="text-muted"><%= new Date(order.updatedAt).toLocaleDateString() %></small>
                </div>

                <!-- Processing -->
                <div class="tracking-step <%= order.steps.includes('processing') ? 'completed' : '' %>">
                    <div class="icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <h6>Processing</h6>
                    <small class="text-muted"><%= new Date(order.updatedAt).toLocaleDateString() %></small>
                </div>

                <!-- Shipped -->
                <div class="tracking-step <%= order.steps.includes('shipped') ? 'completed' : '' %>">
                    <div class="icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <h6>Shipped</h6>
                    <small class="text-muted"><%= new Date(order.updatedAt).toLocaleDateString() %></small>
                </div>

                <!-- Delivered -->
                <div class="tracking-step <%= order.steps.includes('delivered') ? 'completed' : '' %>">
                    <div class="icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <h6>Delivered</h6>
                    <small class="text-muted">Expected <%= order.steps.includes('delivered') ? new Date(order.updatedAt).toLocaleDateString() : '' %></small>
                </div>

            </div>

        </div>
    </div>

</div>
<%- include('layouts/footer') %>